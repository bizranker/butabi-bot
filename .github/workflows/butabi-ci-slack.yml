name: ButabiBot CI 🎛️🕺

on:
  push:
    branches:
      - main

jobs:
  send-slack-message:
    runs-on: ubuntu-latest
    steps:
      - name: Format message
        id: message
        run: |
          echo "DISCO_MESSAGE=\"\ud83c\udfb6 CI Disco Alert\nStayin' alive... barely.\n\n:man_dancing: *John Travolta has entered the pipeline.*\n\n*New push to* \`main\` 🌍\n\n*Commit:* \\`${{ github.sha }}\\`\n*Message:* \"${{ github.event.head_commit.message }}\"\n*Quote:* _\"Whether you're a brother or whether you're a mother, you're pushin' to main.\"_\n\u2014 *ButabiBot, Saturday Night DevOps*\"" >> $GITHUB_ENV

      - name: Send message to Slack
        run: |
          curl -X POST -H 'Content-type: application/json' \
          --data "{\"text\": \"$DISCO_MESSAGE\"}" \
          ${{ secrets.SLACK_WEBHOOK_URL }}